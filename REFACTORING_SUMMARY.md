# Agenté‡æ„æ€»ç»“

## é‡æ„å®Œæˆæƒ…å†µ

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒé‡æ„

#### 1. AgentçŠ¶æ€æœºï¼ˆAgentStateï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/model/AgentState.java`
- **åŠŸèƒ½**: å®šä¹‰äº†Agentçš„9ç§æ‰§è¡ŒçŠ¶æ€ï¼Œæ”¯æŒçŠ¶æ€è½¬æ¢éªŒè¯
- **çŠ¶æ€**: INITIALIZING â†’ THINKING â†’ PLANNING â†’ EXECUTING â†’ OBSERVING â†’ REFLECTING â†’ COMPLETED/FAILED

#### 2. ReActå¾ªç¯å¼•æ“ï¼ˆReActEngineï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ReActEngine.java`
- **åŠŸèƒ½**: å®ç°Reasoning-Actingå¾ªç¯ï¼Œè®©Agentèƒ½å¤Ÿè‡ªä¸»æ€è€ƒã€è¡ŒåŠ¨ã€è§‚å¯Ÿå’Œåæ€
- **æ ¸å¿ƒæµç¨‹**:
  ```
  Think â†’ Act â†’ Observe â†’ Reflect â†’ (ç»§ç»­/å®Œæˆ/é‡è¯•)
  ```

#### 3. æ€è€ƒå¼•æ“ï¼ˆThinkingEngineï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ThinkingEngine.java`
- **åŠŸèƒ½**: åˆ†æå½“å‰æƒ…å†µï¼Œå†³å®šä¸‹ä¸€æ­¥åŠ¨ä½œ
- **æ”¹è¿›**: ä½¿ç”¨LLMè¿›è¡Œæ™ºèƒ½æ€è€ƒï¼Œæ›¿ä»£ç®€å•çš„å…³é”®è¯åŒ¹é…

#### 4. åŠ¨ä½œæ‰§è¡Œå™¨ï¼ˆActionExecutorï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ActionExecutor.java`
- **åŠŸèƒ½**: æ‰§è¡ŒAgenté€‰å®šçš„åŠ¨ä½œï¼ˆå·¥å…·è°ƒç”¨ã€RAGæ£€ç´¢ã€LLMç”Ÿæˆç­‰ï¼‰

#### 5. è§‚å¯Ÿå¼•æ“ï¼ˆObservationEngineï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ObservationEngine.java`
- **åŠŸèƒ½**: è§‚å¯ŸåŠ¨ä½œæ‰§è¡Œç»“æœï¼Œæ›´æ–°ä¸Šä¸‹æ–‡

#### 6. åæ€å¼•æ“ï¼ˆReflectionEngineï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ReflectionEngine.java`
- **åŠŸèƒ½**: è¯„ä¼°ç»“æœï¼Œå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆç»§ç»­/é‡è¯•/å®Œæˆï¼‰

#### 7. æ™ºèƒ½å·¥å…·é€‰æ‹©å™¨ï¼ˆIntelligentToolSelectorï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/IntelligentToolSelector.java`
- **åŠŸèƒ½**: æ ¹æ®ä»»åŠ¡éœ€æ±‚æ™ºèƒ½é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·

#### 8. ä»»åŠ¡åˆ†ç±»å™¨é‡æ„ï¼ˆTaskClassifierï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/TaskClassifier.java`
- **æ”¹è¿›**: ä½¿ç”¨LLMè¿›è¡Œæ™ºèƒ½åˆ†ç±»ï¼Œä¿ç•™å…³é”®è¯åŒ¹é…ä½œä¸ºå¿«é€Ÿè·¯å¾„

#### 9. æ–°çš„AgentæœåŠ¡å®ç°ï¼ˆAgentServiceImplV2ï¼‰
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/impl/AgentServiceImplV2.java`
- **åŠŸèƒ½**: é›†æˆReActæ¶æ„çš„æ–°å®ç°
- **ç‰¹ç‚¹**: ä½¿ç”¨ReActå¾ªç¯æ›¿ä»£åŸæ¥çš„switch-caseæ‰§è¡Œæµç¨‹

### ğŸ“‹ æ–°å¢çš„æ•°æ®ç»“æ„

#### AgentAction
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/AgentAction.java`
- **åŠŸèƒ½**: è¡¨ç¤ºAgentè¦æ‰§è¡Œçš„ä¸€ä¸ªåŠ¨ä½œ
- **ç±»å‹**: TOOL_CALL, RAG_RETRIEVE, LLM_GENERATE, COMPLETEç­‰

#### ActionResult
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/ActionResult.java`
- **åŠŸèƒ½**: åŠ¨ä½œæ‰§è¡Œç»“æœï¼ŒåŒ…å«æˆåŠŸ/å¤±è´¥ä¿¡æ¯

#### AgentStateMachine
- **æ–‡ä»¶**: `backend/src/main/java/com/aiagent/service/AgentStateMachine.java`
- **åŠŸèƒ½**: ç®¡ç†AgentçŠ¶æ€è½¬æ¢

## æ¶æ„å¯¹æ¯”

### æ—§æ¶æ„ï¼ˆé—®é¢˜ï¼‰
```
ç”¨æˆ·è¯·æ±‚ â†’ å…³é”®è¯åˆ†ç±» â†’ switch-caseæ‰§è¡Œ â†’ è¿”å›ç»“æœ
```
- âŒ æ²¡æœ‰æ€è€ƒè¿‡ç¨‹
- âŒ æ— æ³•å¤„ç†å¤æ‚ä»»åŠ¡
- âŒ å·¥å…·é€‰æ‹©è¢«åŠ¨
- âŒ æ— æ³•ä»é”™è¯¯ä¸­å­¦ä¹ 

### æ–°æ¶æ„ï¼ˆReActï¼‰
```
ç”¨æˆ·è¯·æ±‚ â†’ åˆå§‹åŒ– â†’ ReActå¾ªç¯ â†’ è¿”å›ç»“æœ
           â†“
    Think â†’ Act â†’ Observe â†’ Reflect
           â†“         â†“         â†“
        åˆ†ææƒ…å†µ   æ‰§è¡ŒåŠ¨ä½œ   è§‚å¯Ÿç»“æœ   è¯„ä¼°å†³ç­–
           â†“         â†“         â†“
        å†³å®šåŠ¨ä½œ   å·¥å…·/RAG   æ›´æ–°ä¸Šä¸‹æ–‡  ç»§ç»­/å®Œæˆ/é‡è¯•
```
- âœ… è‡ªä¸»æ€è€ƒ
- âœ… å¯ä»¥å¤„ç†å¤æ‚ä»»åŠ¡
- âœ… æ™ºèƒ½å·¥å…·é€‰æ‹©
- âœ… é”™è¯¯æ¢å¤å’Œå­¦ä¹ 

## ä½¿ç”¨æ–°æ¶æ„

### æ–¹å¼1ï¼šæ›¿æ¢ç°æœ‰å®ç°

ä¿®æ”¹ `AgentController`ï¼Œå°† `AgentServiceImpl` æ›¿æ¢ä¸º `AgentServiceImplV2`ï¼š

```java
@Autowired
@Qualifier("agentServiceImplV2")
private IAgentService agentService;
```

### æ–¹å¼2ï¼šä¿ç•™æ—§å®ç°ä½œä¸ºå¤‡é€‰

å¯ä»¥é€šè¿‡é…ç½®é€‰æ‹©ä½¿ç”¨å“ªä¸ªå®ç°ï¼š

```java
@Autowired
@Qualifier("${aiagent.impl:agentServiceImplV2}")
private IAgentService agentService;
```

## å¾…å®Œæˆçš„å·¥ä½œ

### é«˜ä¼˜å…ˆçº§
1. **å®ç°TaskPlanner** - ä»»åŠ¡è§„åˆ’å™¨ï¼Œå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºæ­¥éª¤
2. **å®Œå–„LLMè°ƒç”¨** - å®ç°éæµå¼LLMè°ƒç”¨æ–¹æ³•ï¼Œç”¨äºæ€è€ƒé˜¶æ®µ
3. **ä¿®å¤ç¼–è¯‘é”™è¯¯** - è§£å†³å¯¼å…¥å’Œç±»å‹é—®é¢˜

### ä¸­ä¼˜å…ˆçº§
4. **å¢å¼ºMemorySystem** - æ”¯æŒå…³é”®ä¿¡æ¯æå–å’Œå‘é‡æ£€ç´¢
5. **å®Œå–„RAGåŠŸèƒ½** - å®ç°çœŸæ­£çš„å‘é‡æ£€ç´¢
6. **ä¼˜åŒ–å·¥å…·é€‰æ‹©** - ä½¿ç”¨LLMè¿›è¡Œæ›´æ™ºèƒ½çš„å·¥å…·é€‰æ‹©

### ä½ä¼˜å…ˆçº§
7. **æ€§èƒ½ä¼˜åŒ–** - ç¼“å­˜ã€å¼‚æ­¥å¤„ç†ç­‰
8. **ç›‘æ§å’Œæ—¥å¿—** - æ·»åŠ æ›´è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—

## å…³é”®æ”¹è¿›ç‚¹

### 1. è‡ªä¸»æ€è€ƒèƒ½åŠ›
- ä½¿ç”¨LLMåˆ†æå½“å‰æƒ…å†µ
- æ ¹æ®ä¸Šä¸‹æ–‡å’Œå†å²å†³å®šä¸‹ä¸€æ­¥
- ä¸å†ä¾èµ–ç¡¬ç¼–ç çš„è§„åˆ™

### 2. é”™è¯¯æ¢å¤æœºåˆ¶
- åæ€å¼•æ“åˆ†æå¤±è´¥åŸå› 
- å†³å®šæ˜¯å¦é‡è¯•æˆ–è°ƒæ•´ç­–ç•¥
- ä¸å†ç®€å•é™çº§ä¸ºå¯¹è¯

### 3. çŠ¶æ€ç®¡ç†
- æ˜ç¡®çš„çŠ¶æ€è½¬æ¢
- å¯ä»¥è¿½è¸ªAgentå½“å‰é˜¶æ®µ
- æ”¯æŒæš‚åœå’Œæ¢å¤ï¼ˆæœªæ¥ï¼‰

### 4. å¯æ‰©å±•æ€§
- æ¨¡å—åŒ–è®¾è®¡
- æ˜“äºæ·»åŠ æ–°çš„åŠ¨ä½œç±»å‹
- æ˜“äºé›†æˆæ–°çš„å·¥å…·

## æ³¨æ„äº‹é¡¹

1. **ç¼–è¯‘é”™è¯¯**: å½“å‰æœ‰ä¸€äº›ç¼–è¯‘é”™è¯¯ï¼Œä¸»è¦æ˜¯å¯¼å…¥é—®é¢˜ï¼Œéœ€è¦åœ¨IDEä¸­åˆ·æ–°é¡¹ç›®
2. **LLMè°ƒç”¨**: æ€è€ƒé˜¶æ®µéœ€è¦éæµå¼LLMè°ƒç”¨ï¼Œå½“å‰ä½¿ç”¨ç®€åŒ–å®ç°
3. **æµ‹è¯•**: æ–°æ¶æ„éœ€è¦å……åˆ†æµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯ReActå¾ªç¯çš„è¾¹ç•Œæƒ…å†µ
4. **æ€§èƒ½**: ReActå¾ªç¯å¯èƒ½å¢åŠ LLMè°ƒç”¨æ¬¡æ•°ï¼Œéœ€è¦æ³¨æ„æˆæœ¬æ§åˆ¶

## ä¸‹ä¸€æ­¥

1. ä¿®å¤ç¼–è¯‘é”™è¯¯
2. å®ç°TaskPlanner
3. å®Œå–„LLMè°ƒç”¨æ–¹æ³•
4. ç¼–å†™å•å…ƒæµ‹è¯•
5. é›†æˆæµ‹è¯•æ–°æ¶æ„

---

**é‡æ„å®Œæˆæ—¶é—´**: 2025-01-XX
**é‡æ„äºº**: AI Assistant

